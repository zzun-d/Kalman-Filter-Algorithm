# 01. 칼만필터 개요

---

## 칼만필터

상태공간 방정식을 이용한 **추정기**로, Recursive 구조를 갖는 최적 데이터 처리 알고리즘

> 추정기?
> 정보로부터 미지의 양을 추정하는 알고리즘, 여기서 미지의 양은 **상태변수**, **시스템 파라미터**로 표현

<br>

**추정기의 종류**

1. 예측

- 과거부터 현재까지 측정한 데이터를 기반으로 미래의 특정 시점의 상태 변수를 추정하는 것
- 천체 궤적 추정, 주식 및 상품의 미래 가격 유추 등에 사용

2. 필터링

- 현재의 상태 변수 추정
- 센서 측정 데이터를 기반으로 항공기나 미사일, 로봇의 현재 상태를 실시간으로 추정하는 데 사용

3. 스무딩

- 과거부터 미래의 데이터까지 이용하여 현재의 상태변수를 추정
- 실험을 통해 축적한 측정 데이터를 후처리하여 시스템의 상태 추정에 사용

## 시스템 운동 모델

시스템 운동 모델은 시스템에서 일어나는 일련의 현상을 수학적으로 모델링한 것으로 **상태공간 방정식** 형태로 만들 수 있다

#### $\dot x(t) = f(x(t), u(t), w(t), t)$

$x(t)$는 t시점에서의 상태변수, $u(t)$는 시스템의 입력 값, $w(t)$는 노이즈이다.

$w(t)$는 불확실성을 확률적으로 표한하기 위해 도입한 변수로 이것을 모델링한 것을 노이즈 모델이라 함.

함수 $f$는 시스템 파라미터가 포함된 시간에 따라 변화하는 비선형 함수로 볼 수 있다.

결과적으로 **미래의 상태**는 **현재 상태**에서 **시스템이 갖는 환경 값**과 **노이즈**를 고려하여 계산된다는 것이다

이 함수를 알고리즘으로 구현하기 위해서는 연속데이터가 아닌 이산데이터로 알고리즘에 입력으로 들어가야 한다.

그렇다면 위의 상태공간 방정식을 일정한 타임 스탬프를 갖는 시스템 모델로 변형해보자

#### $x(k+1) = f(x(k), u(k), w(k), k)$

여기에서 $k$는 $t$와 같은 의미가 아닌, 일정한 타임 스탬프 $T$를 곱한 $kT$를 의미한다.
나머지 변수의 의미는 위와 동일하며, 시스템의 상태변수를 갱신시키는 알고리즘이 된다.

## 시스템 측정 모델

시스템 측정 모델은 측정값과 시스템의 상태변수 및 파라미터와의 관계를 수학적으로 표현한 모델이다.

시스템 측정 모델을 사용하는 이유는 센서에서 측정된 데이터에는 노이즈와 바이어스 등으로 정확한 자신의 상태를 측정할 수 없기 때문에 이 측정 모델을 사용한다.

#### $z(k) = h(x(k), k) + v(k)$

$z(k)$는 측정값이며, $v(k)$는 노이즈, $h(x(k),k)$는 시스템의 상태변수와 시스템의 출력 사이의 함수 관계를 표현하는 비선형 함수이다.

## 칼만필터 정리

시스템에 들어오는 입력은 제어 외에도 여러 환경 변수들이 존재한다. 알지 못하는 변수에 의해 측정되는 시스템의 출력은 불확실성이 내재되어 있는데, 이 러한 환경에서 칼만필터는 사용할 수 있는 모든 측정 데이터와 시스템 운동 및 센서의 정보, 시스템 모델의 불확실성과 측정 오류에 대한 표현 등을 결합해 추정 오차가 확률적으로 최소화 되는 방식으로 상태변수를 추정하게 된다.

$u(k)$와 노이즈 값 $w(k)$의 입력이 시스템 모델로 들어가 갱신된 $x(k)$ 상태 변수가 나오고,
이 후 측정 모델을 통해 또 한번의 측정 노이즈 값과 합쳐져 $z(k)$ 값이 나오게 된다.
